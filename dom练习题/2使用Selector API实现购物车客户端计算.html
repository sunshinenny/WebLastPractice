<!DOCTYPE HTML>
<html>
<head>
<title>使用Selector API实现购物车客户端计算</title>
<meta charset="utf-8" />
<style>
	table{width:600px; text-align:center;
		border-collapse:collapse;
	}
	td,th{border:1px solid black}
	td[colspan="3"]{text-align:right;}
	#data tbody td:last-child{background:red;}
	#data tfoot>tr>td:last-child{background:green;}
</style>
<script type="text/javascript" >
	window.onload=function startValue(){
		var first=document.getElementById('first');
		var second=document.getElementById('second');
		var third=document.getElementById('third');
		var all=document.getElementById('all');
		
		var allMoney=first.innerText*4488+second.innerText*5288+third.innerText*4288;
		
		all.innerText='¥'+allMoney;
	}
	
	
	var goodsNums;//全局变量
	
	function calc(str,way){
		var nums=document.getElementById(str);//定位到数量
		var t;		
		if(str=='first') t=4488;
		if(str=='second') t=5288;
		if(str=='third') t=4288;
		
		var goodsNums=nums.innerText*1;
		var money=goodsNums*t;

		if(way=='cut'){
			if(nums.innerText*1>=1){
				if(str=='first') cut(str,t);
				if(str=='second') cut(str,t);
				if(str=='third') cut(str,t);
				}
			}
		if(way=='add'){
				if(str=='first') add(str,t);
				if(str=='second') add(str,t);
				if(str=='third') add(str,t);			
				
	}	
		function cut(str,t){
			goodsNums--; 
			setMoney(goodsNums,str);
			money=money-t;
			nums.innerText=goodsNums;
			setValue();
		}
	
		function add(str,t){
			goodsNums++;
			setMoney(goodsNums,str);
			money=goodsNums*t;
			nums.innerText=goodsNums;
			setValue();
		}
		
	}
	function setMoney(num,str){
		var goodMoney;
		if(str=='first') {str=1;goodMoney=4488;}
		if(str=='second') {str=2;goodMoney=5288;}
		if(str=='third') {str=3;goodMoney=4288;}
		var nums=document.getElementById(str);
		nums.innerText='¥'+goodMoney*num;
	}
	
	function setValue(){
		var first=document.getElementById('first');
		var second=document.getElementById('second');
		var third=document.getElementById('third');
		var all=document.getElementById('all');
		
		var allMoney=first.innerText*4488+second.innerText*5288+third.innerText*4288;
		
		all.innerText='¥'+allMoney;
	}
	

	
</script>
</head>
<body>
	<table id="data">
		<thead>
			<tr>
				<th>商品名称</th>
				<th>单价</th>
				<th>数量</th>
				<th>小计</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>iPhone6</td>
				<td>&yen;4488</td>
				<td>
					<button onclick="calc('first','cut')">-</button>
					<span id="first">1</span>
					<button onclick="calc('first','add')">+</button>
				</td>
				<td id="1">&yen;4488</td>
			</tr>
			<tr>
				<td>iPhone6 plus</td>
				<td>&yen;5288</td>
				<td>
				<button onclick="calc('second','cut')">-</button>
				<span id="second">1</span>
				<button onclick="calc('second','add')">+</button>
				</td>
				<td id="2">&yen;5288</td>
			</tr>
			<tr>
				<td>iPad Air 2</td>
				<td>&yen;4288</td>
				<td>
					 <button onclick="calc('third','cut')">-</button>
					<span  id="third">1</span>
					<button onclick="calc('third','add')">+</button>
				</td>
				<td id="3">&yen;4288</td>
			</tr>
		</tbody>
		<tfoot>
			<tr>
				<td colspan="3">Total: </td>
				<td id="all">&yen;value</td>
			</tr>
		</tfoot>
	</table>
	
</body>
</html>
